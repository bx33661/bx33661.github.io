---
// 临时测试页面 - 强制启用 GA 来验证代码
import Layout from '@/layouts/Layout.astro'
import { GOOGLE_ANALYTICS_ID } from '@/config/env'
---

<Layout>
  <div class="max-w-4xl mx-auto p-8">
    <h1 class="text-3xl font-bold mb-6">Google Analytics 测试页面</h1>
    
    <div class="bg-card border rounded-lg p-6 mb-6">
      <h2 class="text-xl font-semibold mb-4">当前配置信息</h2>
      <ul class="space-y-2">
        <li><strong>测量 ID:</strong> {GOOGLE_ANALYTICS_ID || '未配置'}</li>
        <li><strong>环境:</strong> {import.meta.env.PROD ? '生产环境' : '开发环境'}</li>
        <li><strong>分析状态:</strong> {import.meta.env.PROD ? '已启用' : '已禁用（开发环境）'}</li>
      </ul>
    </div>

    <div class="bg-card border rounded-lg p-6">
      <h2 class="text-xl font-semibold mb-4">标准 Google Analytics 代码</h2>
      <pre class="bg-muted p-4 rounded text-sm overflow-x-auto"><code>{`<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3L1EBMC2D5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3L1EBMC2D5');
</script>`}</code></pre>
    </div>

    <!-- 强制加载 GA 用于测试 -->
    <script is:inline async src="https://www.googletagmanager.com/gtag/js?id=G-3L1EBMC2D5"></script>
    <script is:inline>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      
      gtag('config', 'G-3L1EBMC2D5');
      
      // 测试事件
      gtag('event', 'page_view', {
        page_title: 'GA Test Page',
        page_location: window.location.href
      });
      
      console.log('Google Analytics 测试代码已加载');
      console.log('测量 ID: G-3L1EBMC2D5');
    </script>
  </div>
</Layout>