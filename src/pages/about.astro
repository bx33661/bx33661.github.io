---
import '@/styles/about-desktop.css'

import Breadcrumbs from '@/components/Breadcrumbs.astro'
import Link from '@/components/Link.astro'
import PageHead from '@/components/PageHead.astro'
import { Icon } from 'astro-icon/components'
import Layout from '@/layouts/Layout.astro'
import { BASE_URL } from '@/config/env'
import { GALLERY_IMAGES } from '@/data/gallery'
import { getAllProjects, getProjectSlug } from '@/lib/data-utils'

const currentUrl = Astro.url.toString()
const featuredProjects = (await getAllProjects()).slice(0, 6)

const milestones = [
  {
    period: '2023 - è‡³ä»Š',
    title: 'æµ·å—å¤§å­¦ Â· ä¿¡æ¯å®‰å…¨',
    subtitle: 'ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢',
    summary:
      'å¤§å­¦æœ¬ç§‘ä¸“ä¸šå­¦ä¹ ',
    tags: ['ä¿¡æ¯å®‰å…¨', 'å·¥ç¨‹åŸºç¡€', 'å®‰å…¨ç ”ç©¶'],
  },
  {
    period: '2023 - è‡³ä»Š',
    title: 'HnuSec æ ¸å¿ƒæˆå‘˜',
    subtitle: 'CTF / Web Security',
    summary:
      'ä¸“æ³¨ Web æ–¹å‘æ”»é˜²ä¸é¢˜ç›®ç ”ç©¶ï¼ŒæŒç»­è¾“å‡ºå¤ç›˜ä¸æŠ€æœ¯æ²‰æ·€ï¼Œå¼ºåŒ–å®æˆ˜åä½œèƒ½åŠ›ã€‚',
    tags: ['CTF', 'Web å®‰å…¨', 'å›¢é˜Ÿåä½œ'],
  },
]

const expertise = [
  {
    icon: 'lucide:shield-check',
    title: 'Security',
    points: ['å®‰å…¨ç ”ç©¶åˆ†æ', 'æ¼æ´åˆ†æä¸å¤ç°', 'æŒç»­å­¦ä¹ '],
  },
  {
    icon: 'lucide:cpu',
    title: 'Engineering',
    points: ['é¡¹ç›®å¼€å‘', 'åº”ç”¨å®è·µ', 'è¿ç»´åˆ†æ'],
  },
  {
    icon: 'lucide:workflow',
    title: 'AI Workflow',
    points: ['LLM åº”ç”¨é›†æˆ', 'Agentåº”ç”¨', 'AI4Sec'],
  },
]

const principles = [
  'ç›¸ä¿¡éªŒè¯ï¼Œè€Œä¸æ˜¯æ„Ÿè§‰ã€‚',
  'æ­£è§†æ—¶ä»£ï¼Œé¢å‘æ—¶ä»£',
  'ç«‹è¶³ç°å®çº¦æŸï¼ŒæŒç»­å­¦ä¹ ï¼ŒæŒç»­çªç ´ï¼ï¼',
]


const focusItems = [
  {
    icon: 'lucide:scan-search',
    title: 'æ¼æ´ç ”ç©¶',
    detail: 'æŒç»­è·Ÿè¿›ï¼ŒæŒç»­å…³æ³¨',
  },
  {
    icon: 'lucide:bot',
    title: 'AI4Sec',
    detail: 'è¿™ä¸ªæ—¶ä»£ä¼šä½•å»ä½•ä»',
  },
  {
    icon: 'lucide:factory',
    title: 'å¼€æº',
    detail: 'OpenSource',
  },
]

const galleryImages = GALLERY_IMAGES.slice(0, 8).map((item) => ({
  ...item,
  src: `${BASE_URL}gallery/${item.file}`,
  shape: item.shape || '',
}))

const getProjectIcon = (tags: string[]) => {
  if (tags.includes('security') || tags.includes('ctf') || tags.includes('web')) return 'ğŸ›¡ï¸'
  if (tags.includes('python')) return 'ğŸ'
  if (tags.includes('react') || tags.includes('typescript')) return 'âš›ï¸'
  if (tags.includes('ai') || tags.includes('ml')) return 'ğŸ¤–'
  return 'ğŸ’»'
}

const getProjectHref = (project: (typeof featuredProjects)[number]) => {
  return project.data.link || `/projects/${getProjectSlug(project)}/`
}

const isExternalHref = (href: string) => /^https?:\/\//.test(href)
---

<Layout canonicalUrl={currentUrl} isWide={true}>
  <PageHead
    slot="head"
    title="å…³äºæˆ‘"
    description="BX çš„èƒŒæ™¯ã€ç ”ç©¶æ–¹å‘ä¸é¡¹ç›®å®è·µã€‚"
    canonicalURL={currentUrl}
  />

  <div class="about-page">
    <div class="about-shell">
      <Breadcrumbs items={[{ label: 'å…³äºæˆ‘', icon: 'lucide:user-round' }]} />

      <section class="about-panel about-hero">
        <div class="about-hero__copy">
          <p class="about-kicker">Profile</p>
          <h1>Bx/Bpple</h1>
          <p class="about-lead">
            æˆ‘æ˜¯Bxï¼Œæ¬¢è¿å…³æ³¨ï¼Œæˆ‘ä»¬ä¸€èµ·å­¦ä¹ ï¼Œä¸€èµ·è¿›æ­¥ã€‚
          </p>
          <div class="about-focus-grid">
            {
              focusItems.map((item) => (
                <article class="about-focus-card">
                  <div class="about-focus-card__title">
                    <Icon name={item.icon} class="size-4" />
                    <h3>{item.title}</h3>
                  </div>
                  <p>{item.detail}</p>
                </article>
              ))
            }
          </div>
          <div class="about-hero__actions">
            <a href="mailto:bx33661@gmail.com" class="about-btn about-btn--primary">
              <Icon name="lucide:mail" class="size-4" />
              é‚®ä»¶è”ç³»
            </a>
            <a
              href="https://github.com/bx33661"
              target="_blank"
              rel="noopener noreferrer"
              class="about-btn"
            >
              <Icon name="lucide:github" class="size-4" />
              GitHub ä»“åº“
            </a>
          </div>
        </div>

        <aside class="about-profile">
          <p class="about-profile__status">
            <span aria-hidden="true"></span>
            å¯æ¥å—åˆä½œå’¨è¯¢
          </p>
          <div class="about-profile__avatar-wrap">
            <img
              src="/static/blogo.jpg"
              alt="BX å¤´åƒ"
              class="about-profile__avatar"
              loading="lazy"
              decoding="async"
              width="220"
              height="220"
            />
          </div>
          <h2>BX</h2>
          <p>ç½‘ç»œå®‰å…¨ç ”ç©¶ / å·¥ç¨‹å¼€å‘</p>
          <ul>
            <li>
              <Icon name="lucide:map-pin" class="size-4" />
              ä¸­å›½
            </li>
            <li>
              <Icon name="lucide:briefcase-business" class="size-4" />
              ä¸€èµ·è§è¯æ˜Ÿè¾°å¤§æµ·
            </li>
            <li>
              <Icon name="lucide:clock-3" class="size-4" />
              æ¬¢è¿å¤§å®¶äº¤æµå­¦ä¹ 
            </li>
          </ul>
        </aside>
      </section>

      <section class="about-main-grid">
        <div class="about-panel about-timeline">
          <div class="about-section-head">
            <h2>æˆé•¿è·¯å¾„</h2>
            <p>Education / Experience</p>
          </div>

          <ol class="about-timeline-list">
            {
              milestones.map((item) => (
                <li class="about-step">
                  <span class="about-step__period">{item.period}</span>
                  <h3>{item.title}</h3>
                  <p class="about-step__subtitle">{item.subtitle}</p>
                  <p class="about-step__summary">{item.summary}</p>
                  <div class="about-step__tags">
                    {item.tags.map((tag) => <span>{tag}</span>)}
                  </div>
                </li>
              ))
            }
          </ol>
        </div>

        <div class="about-side-stack">
          <section class="about-panel about-expertise">
            <div class="about-section-head">
              <h2>èƒ½åŠ›çŸ©é˜µ</h2>
              <p>Core Capabilities</p>
            </div>

            <div class="about-expertise-grid">
              {
                expertise.map((group) => (
                  <article class="about-expertise-card">
                    <div class="about-expertise-card__title">
                      <Icon name={group.icon} class="size-4" />
                      <h3>{group.title}</h3>
                    </div>
                    <ul>
                      {group.points.map((point) => <li>{point}</li>)}
                    </ul>
                  </article>
                ))
              }
            </div>
          </section>

          <section class="about-panel about-principles">
            <div class="about-section-head">
              <h2>åä½œåŸåˆ™</h2>
              <p>How I Work</p>
            </div>
            <ul>
              {principles.map((item) => <li>{item}</li>)}
            </ul>
          </section>
        </div>
      </section>

      <section class="about-panel about-projects">
        <div class="about-section-head about-section-head--row">
          <div>
            <h2>é¡¹ç›®ä¸å®è·µ</h2>
            <p>Selected Work</p>
          </div>
          <Link href="/projects/" class="about-inline-link">æŸ¥çœ‹å…¨éƒ¨é¡¹ç›®</Link>
        </div>

        <div class="about-project-grid">
          {
            featuredProjects.map((project) => {
              const projectHref = getProjectHref(project)
              const isExternal = isExternalHref(projectHref)

              return (
                <a
                  href={projectHref}
                  target={isExternal ? '_blank' : undefined}
                  rel={isExternal ? 'noopener noreferrer' : undefined}
                  class="about-project-card"
                >
                  <div class="about-project-card__top">
                    <span class="about-project-card__icon">{getProjectIcon(project.data.tags)}</span>
                    <span class="about-project-card__year">
                      {(project.data.endDate || project.data.startDate)?.getFullYear() || 'Now'}
                    </span>
                  </div>
                  <h3>{project.data.name}</h3>
                  <p>{project.data.description}</p>
                  <div class="about-project-card__tags">
                    {project.data.tags.slice(0, 3).map((tag) => <span>{tag}</span>)}
                  </div>
                  <span class="about-project-card__more">
                    {isExternal ? 'æŸ¥çœ‹é¡¹ç›®' : 'æŸ¥çœ‹è¯¦æƒ…'}
                    <Icon name="lucide:arrow-up-right" class="size-3.5" />
                  </span>
                </a>
              )
            })
          }
        </div>
      </section>

      <section class="about-panel about-gallery">
        <div class="about-section-head about-section-head--row">
          <div>
            <h2>ç”Ÿæ´»ç‰‡æ®µ</h2>
            <p>Personal Moments</p>
          </div>
          <Link href="/bento/" class="about-inline-link">æŸ¥çœ‹æ›´å¤š</Link>
        </div>

        <div class="about-gallery-grid">
          {
            galleryImages.map((image) => (
              <figure class={`about-shot ${image.shape}`.trim()}>
                <img src={image.src} alt={image.alt} loading="lazy" decoding="async" />
                <figcaption>
                  <span>{image.title}</span>
                  <time>{image.date}</time>
                </figcaption>
              </figure>
            ))
          }
        </div>
      </section>

      <section class="about-panel about-cta">
        <div>
          <h2>å¦‚éœ€å®‰å…¨ç ”ç©¶æˆ–è€…æ—¥å¸¸äº¤æµ</h2>
          <p>æ¬¢è¿é‚®ä»¶æ²Ÿé€šï¼Œæˆ‘ä¼šåŠæ—¶å›å¤ğŸ˜„ã€‚</p>
        </div>
        <div class="about-hero__actions">
          <a href="mailto:bx33661@gmail.com" class="about-btn about-btn--primary">å‘é€é‚®ä»¶</a>
          <Link href="/blog/" class="about-btn">æŸ¥çœ‹åšå®¢æ–‡ç« </Link>
        </div>
      </section>
    </div>
  </div>
</Layout>
