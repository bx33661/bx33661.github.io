---
import Link from '@/components/Link.astro'
import PageHead from '@/components/PageHead.astro'
import { BentoGrid, BentoCard, ProjectCard, InfoCard } from '@/components/react/bento-grid'
import { Card3D } from '@/components/react/card-3d'
import AnimatedElement from '@/components/react/animated-element'
import { ScrollReveal } from '@/components/react/scroll-animations'
import { ImageZoom } from '@/components/react/image-zoom'
import { buttonVariants } from '@/components/ui/button'
import Layout from '@/layouts/Layout.astro'
import { Icon } from 'astro-icon/components'
import Breadcrumbs from '@/components/Breadcrumbs.astro'
import { getAllProjects } from '@/lib/data-utils'
import { BASE_URL } from '@/config/env'

const currentUrl = Astro.url;
const allProjects = await getAllProjects();

const galleryImages = [
  {
    src: `${BASE_URL}gallery/79d35189354e2824167cfebb10876af4.jpg`,
    alt: 'æ–°ä¹¡',
    title: 'labubu',
    description: 'è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´',
    date: '2025-07-05'
  },
  {
    src: `${BASE_URL}gallery/738eadca2488bd4f583bb071d15fc038.jpg`, 
    alt: 'æ–°ä¹¡',
    title: 'å®æ³‰',
    description: 'è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´',
    date: '2025-07-05'
  },
  {
    src: `${BASE_URL}gallery/c9531bcaeefed42bb36b974696149c7a.jpg`,
    alt: 'æ–°ä¹¡', 
    title: 'å®æ³‰',
    description: 'è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´',
    date: '2025-07-05'
  },
  {
    src: `${BASE_URL}gallery/3a05e267fc3eb4a6c146489836f5d50e.jpg`,
    alt: 'æµ·å¤§', 
    title: 'ç¾ä¸½æ ¡å›­',
    description: 'è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´',
    date: '2025-05-05'
  },
  {
    src: `${BASE_URL}gallery/cd3ca9f14be50495c1be8ed017c7b348.jpg`,
    alt: 'æµ·å—', 
    title: 'æµ·å—è½æ—¥',
    description: 'è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´',
    date: '2024-07-05'
  },
  {
    src: `${BASE_URL}gallery/fb450aaf347e5d8e64d0341cf3b23b61.jpg`,
    alt: 'æ´›é˜³', 
    title: 'æ´›é˜³å¤éƒ½',
    description: 'è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´',
    date: '2024-09-05'
  },
  {
    src: `${BASE_URL}gallery/b4fb8f48829b62de174d7b1e24a3b7ca.jpg`,
    alt: 'äº‘æœµ', 
    title: 'äº‘æœµ',
    description: 'è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´',
    date: '2024-10-05'
  },
  {
    src: `${BASE_URL}gallery/2713625f33c9006f62b6e40783e27527.jpg`,
    alt: 'äº‘æœµ', 
    title: 'äº‘æœµ',
    description: 'è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´',
    date: '2024-11-05'
  },
];

const getIcon = (project: any) => {
  const tags = project.data.tags || [];
  if (tags.includes('python')) return 'ğŸ';
  if (tags.includes('react') || tags.includes('vue') || tags.includes('nextjs')) return 'âš›ï¸';
  if (tags.includes('security') || tags.includes('web') || tags.includes('ctf')) return 'ğŸ›¡ï¸';
  if (tags.includes('ai') || tags.includes('ml')) return 'ğŸ¤–';
  if (tags.includes('tool') || tags.includes('utils')) return 'ğŸ› ï¸';
  return 'ğŸ’»';
};
---

<Layout canonicalUrl={currentUrl.toString()}>
  <PageHead slot="head" title="ä¸ªäººç®€å† - BX" description="BX çš„ä¸ªäººä»‹ç»ã€é¡¹ç›®ä¸å®‰å…¨ç ”ç©¶ç»å†ã€‚" canonicalURL={currentUrl.toString()} />
  
  <div class="flex flex-col gap-y-12 px-4 py-8 sm:px-8 lg:px-16 max-w-7xl mx-auto">
    <Breadcrumbs items={[{ label: 'ä¸ªäººç®€å†', icon: 'lucide:user' }]} />
    
    <!-- Hero Section with 3D Card -->
    <AnimatedElement client:load animation="scaleIn" duration={0.8}>
      <Card3D client:load className="w-full" intensity={14}>
        <div class="bg-card/70 dark:bg-card/80 backdrop-blur-md p-8 md:p-12 rounded-3xl border border-border/60 shadow-xl flex flex-col md:flex-row items-center gap-8 md:gap-12 text-center md:text-left relative overflow-hidden">
          <div class="absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-secondary/10 pointer-events-none"></div>
          <div class="relative group shrink-0" aria-label="ä¸ªäººå¤´åƒ">
            <div class="w-32 h-32 md:w-40 md:h-40 rounded-2xl overflow-hidden border border-border/70 shadow-lg group-hover:scale-105 transition-transform duration-400 ease-out">
              <img src="/static/blogo.jpg" alt="BX å¤´åƒ" class="w-full h-full object-cover" loading="lazy" decoding="async" width="160" height="160" />
            </div>
            <div class="absolute -inset-1 rounded-2xl ring-1 ring-primary/20 blur-md"></div>
          </div>
          
          <div class="flex-1 space-y-4 relative z-10">
            <div class="inline-flex items-center gap-2 rounded-full bg-primary/10 text-primary px-3 py-1 text-sm font-medium">
              <Icon name="lucide:sparkles" class="size-4" /> å®‰å…¨ç ”ç©¶ Â· åˆ†äº« Â· æ„å»º
            </div>
            <h1 class="text-4xl md:text-6xl font-black tracking-tight text-foreground">
              BX
            </h1>
            <p class="text-lg md:text-xl font-medium text-muted-foreground">
              ç½‘ç»œå®‰å…¨ç ”ç©¶å‘˜ ï½œ Web å®‰å…¨ ï½œ AI åº”ç”¨
            </p>
            <p class="text-base md:text-lg text-muted-foreground/90 max-w-2xl leading-relaxed">
              ä¸“æ³¨ Web å®‰å…¨ã€AI åº”ç”¨ä¸æ”»é˜²ç ”ç©¶ï¼Œè¿½æ±‚ã€Œå¥½ç”¨ã€å¯è§£é‡Šã€æ˜“ç»´æŠ¤ã€çš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¹äºå°†ç»éªŒè¾“å‡ºä¸ºæ–‡ç« ä¸å·¥å…·ã€‚
            </p>
            <div class="flex flex-wrap gap-3 pt-4 justify-center md:justify-start">
              <a href="https://github.com/bx33661" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-primary text-primary-foreground hover:bg-primary/90 transition-all duration-200 shadow-sm">
                <Icon name="lucide:github" class="size-4" />
                <span class="font-medium">GitHub</span>
              </a>
              <a href="mailto:bx33661@gmail.com" class="inline-flex items-center gap-2 px-4 py-2 rounded-full border border-border/70 bg-background/70 text-foreground hover:border-primary/60 hover:text-primary transition-all duration-200">
                <Icon name="lucide:mail" class="size-4" />
                <span class="font-medium">é‚®ä»¶è”ç³»</span>
              </a>
              <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full border border-border/70 bg-background/70 text-foreground relative group hover:border-primary/60 transition-all duration-200 cursor-pointer">
                <Icon name="lucide:message-circle" class="size-4" />
                <span class="font-medium">WeChat</span>
                <span class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 text-xs bg-foreground text-background rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-all duration-200 whitespace-nowrap pointer-events-none translate-y-2 group-hover:translate-y-0">bx33661</span>
              </div>
            </div>
          </div>
        </div>
      </Card3D>
    </AnimatedElement>

    <!-- Bento Grid Section -->
    <section class="space-y-8">
       <AnimatedElement client:load animation="slideUp" delay={0.2}>
        <div class="flex items-center justify-between mb-8">
          <h2 class="text-3xl font-bold flex items-center gap-3">
            <Icon name="lucide:grid" class="size-8" />
            å…¨æ™¯æ¦‚è§ˆ
          </h2>
          <span class="text-muted-foreground text-sm font-medium px-3 py-1 rounded-full bg-muted">Welcome to my world</span>
        </div>
        
        <BentoGrid className="auto-rows-[minmax(180px,auto)] gap-6">
          
          <!-- Education - Pastel Green/Emerald -->
          <InfoCard 
            client:visible
            title="æ•™è‚²ç»å†" 
            subtitle="æµ·å—å¤§å­¦" 
            content="ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢ Â· ä¿¡æ¯å®‰å…¨ä¸“ä¸š"
            icon="ğŸ“"
            span="md:col-span-2"
            gradient="bg-gradient-to-br from-[#E0F7FA] to-[#B2DFDB] dark:from-emerald-900/30 dark:to-teal-900/30 border-emerald-100 dark:border-emerald-800"
          />

          <!-- HnuSec - Pastel Red/Rose -->
          <InfoCard 
            client:visible
            title="HnuSec" 
            subtitle="æ ¸å¿ƒæˆå‘˜" 
            content="æµ·å—å¤§å­¦ç½‘ç»œå®‰å…¨æˆ˜é˜Ÿï¼Œä¸“æ³¨äºCTFç«èµ›ä¸å®æˆ˜æ”»é˜²æŠ€æœ¯ç ”ç©¶ã€‚"
            image="/static/HnuSec.jpg"
            span="md:col-span-1"
            gradient="bg-gradient-to-br from-[#FFEBEE] to-[#FFCDD2] dark:from-red-900/30 dark:to-pink-900/30 border-red-100 dark:border-red-800"
          />

          <!-- XMCVE - Pastel Purple -->
          <InfoCard 
            client:visible
            title="XMCVE" 
            subtitle="æ¼æ´ç ”ç©¶" 
            content="ä¸“æ³¨äºé€šç”¨æ¼æ´æŒ–æ˜ä¸å®‰å…¨ç ”ç©¶ï¼Œè‡´åŠ›äºæå‡è½¯ä»¶å®‰å…¨æ€§ã€‚"
            icon="ğŸ›"
            span="md:col-span-1"
            gradient="bg-gradient-to-br from-[#F3E5F5] to-[#E1BEE7] dark:from-purple-900/30 dark:to-violet-900/30 border-purple-100 dark:border-purple-800"
          />

          <!-- Fruit-Guardians - Pastel Indigo -->
          <InfoCard 
            client:visible
            title="Fruit-Guardians" 
            subtitle="å¼€æºç¤¾åŒº" 
            content="ä¸“æ³¨äºå®‰å…¨å·¥å…·å¼€å‘ä¸è‡ªåŠ¨åŒ–å®¡è®¡çš„å¼€æºç»„ç»‡ï¼Œç»´æŠ¤å¤šä¸ªå®‰å…¨é¡¹ç›®ã€‚"
            image="/static/fruit.png"
            span="md:col-span-1"
            gradient="bg-gradient-to-br from-[#E8EAF6] to-[#C5CAE9] dark:from-indigo-900/30 dark:to-blue-900/30 border-indigo-100 dark:border-indigo-800"
          />

          <!-- Project - Pastel Orange/Peach -->
           <a href="https://github.com/Fruit-Guardians/PureAutoCodeql" target="_blank" class="contents md:col-span-1 group">
             <div class="h-full w-full md:col-span-1">
               <ProjectCard
                 client:visible
                 title="PuraAutoCodeQL"
                 description="è‡ªåŠ¨åŒ– CodeQL åˆ†æå·¥å…·"
                 icon="ğŸš€"
                 color="from-[#FFE0B2] to-[#FFCC80] dark:from-orange-900/30 dark:to-amber-900/30 text-orange-900 dark:text-orange-100"
                 span="h-full w-full"
               />
             </div>
           </a>
           
           <!-- Research Focus - Pastel Blue -->
           <BentoCard client:visible className="md:col-span-2 bg-gradient-to-br from-[#E3F2FD] to-[#BBDEFB] dark:from-blue-900/30 dark:to-cyan-900/30 border-blue-100 dark:border-blue-800">
             <div class="flex flex-col h-full">
               <div class="flex items-center gap-3 mb-4">
                 <div class="p-2 rounded-lg bg-white/50 dark:bg-black/20 backdrop-blur-sm">
                   <span class="text-2xl">ğŸ”¬</span>
                 </div>
                 <h3 class="text-xl font-bold text-gray-800 dark:text-white">ç ”ç©¶æ–¹å‘</h3>
               </div>
               <div class="flex flex-wrap gap-2">
                 {['Web å®‰å…¨', 'AI å®‰å…¨åº”ç”¨', 'ç½‘ç»œæ”»é˜²', 'æ¼æ´æŒ–æ˜'].map(tag => (
                   <span class="px-4 py-1.5 rounded-full bg-white/60 dark:bg-white/10 border border-white/20 text-sm font-semibold text-gray-700 dark:text-gray-200 shadow-sm">
                     {tag}
                   </span>
                 ))}
               </div>
               <p class="mt-6 text-sm font-medium text-gray-600 dark:text-gray-300 leading-relaxed">
                 è‡´åŠ›äºç ”ç©¶ Web å®‰å…¨å’Œæ¢ç´¢æ–°å…´ AI-LLM æŠ€æœ¯çš„åº”ç”¨ä¸å‘å±•ï¼Œä»¥åŠå‰æ²¿ç½‘ç»œæ”»é˜²æŠ€æœ¯çš„ç ”ç©¶ã€‚
               </p>
             </div>
           </BentoCard>

           <!-- Bio / Motto - Modern Dark -->
           <BentoCard client:visible className="lg:col-span-4 md:col-span-2 flex items-center justify-center bg-[#263238] text-white min-h-[180px] relative overflow-hidden group">
              <!-- Decorative elements -->
              <div class="absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full -translate-y-1/2 translate-x-1/4 blur-3xl group-hover:bg-white/10 transition-colors duration-500"></div>
              <div class="absolute bottom-0 left-0 w-48 h-48 bg-white/5 rounded-full translate-y-1/2 -translate-x-1/4 blur-2xl group-hover:bg-white/10 transition-colors duration-500"></div>
              
              <div class="flex flex-col items-center text-center p-8 relative z-10">
                <Icon name="lucide:quote" class="size-10 text-white/20 mb-6" />
                <p class="text-3xl md:text-4xl font-serif italic tracking-wider text-white/90 leading-relaxed">
                  "ä¸€èµ·è§è¯æ˜Ÿè¾°å¤§æµ·"
                </p>
              </div>
           </BentoCard>

        </BentoGrid>
      </AnimatedElement>
    </section>

    <!-- Other Projects Section -->
    <section class="space-y-6">
      <div class="flex items-center gap-3 mb-6">
        <h2 class="text-2xl font-bold flex items-center gap-2">
          <Icon name="lucide:folder-git-2" class="size-6" />
          æ›´å¤šé¡¹ç›®
        </h2>
        <div class="h-px flex-1 bg-border/60"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {allProjects.map((project) => (
          <a 
            href={project.data.link || '#'} 
            target="_blank" 
            class="group relative flex flex-col p-5 rounded-xl border border-border/50 bg-card/50 hover:bg-card hover:border-border transition-all duration-300 hover:shadow-sm overflow-hidden"
          >
            <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity text-4xl grayscale group-hover:grayscale-0">
              {getIcon(project)}
            </div>
            
            <div class="flex items-start justify-between mb-3 z-10">
              <div class="p-2 rounded-lg bg-primary/5 text-primary group-hover:bg-primary/10 transition-colors">
                <span class="text-xl">{getIcon(project)}</span>
              </div>
              {project.data.tags && (
                 <div class="flex gap-1 flex-wrap justify-end max-w-[50%]">
                  {project.data.tags.slice(0, 2).map(tag => (
                    <span class="text-[10px] px-1.5 py-0.5 rounded-full bg-muted text-muted-foreground uppercase tracking-wider">
                      {tag}
                    </span>
                  ))}
                 </div>
              )}
            </div>

            <h3 class="font-bold text-lg mb-2 group-hover:text-primary transition-colors line-clamp-1 z-10">
              {project.data.name}
            </h3>
            
            <p class="text-sm text-muted-foreground line-clamp-2 mb-4 z-10">
              {project.data.description}
            </p>

            <div class="mt-auto flex items-center text-xs text-muted-foreground font-medium pt-3 border-t border-border/50 group-hover:border-border/80 transition-colors z-10">
              <span class="flex items-center gap-1 group-hover:text-foreground transition-colors">
                View Project <Icon name="lucide:arrow-up-right" class="size-3" />
              </span>
            </div>
          </a>
        ))}
      </div>
    </section>

    <!-- Gallery Section -->
    <section class="space-y-8">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="size-9 rounded-2xl bg-primary/10 text-primary flex items-center justify-center">
            <Icon name="lucide:image" class="size-5" />
          </div>
          <div>
            <h2 class="text-2xl font-bold">ç”Ÿæ´»ç›¸å†Œ</h2>
            <p class="text-sm text-muted-foreground">æ—¥å¸¸ä¸æ—…é€”çš„ç‰‡æ®µï¼Œé›†ä¸­æ”¾åœ¨è¿™é‡Œã€‚</p>
          </div>
        </div>
        <span class="text-xs bg-primary/10 text-primary px-3 py-1 rounded-full border border-primary/20">
          å…± {galleryImages.length} å¼ 
        </span>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
        {galleryImages.map((image, index) => (
          <ScrollReveal client:load direction="up" delay={index * 0.04} threshold={0.15}>
            <div class="group relative overflow-hidden rounded-2xl bg-secondary/15 border border-border/50 hover:border-primary/30 hover:shadow-lg transition-all duration-300" data-index={index} aria-label={`ç›¸å†Œå›¾ç‰‡ ${image.title}`}>
              <div class="aspect-square relative overflow-hidden">
                <ImageZoom
                  client:load
                  src={image.src}
                  alt={image.alt || image.title || 'ç”Ÿæ´»ç›¸å†Œå›¾ç‰‡'}
                  className="w-full h-full object-cover"
                  loading={index < 6 ? 'eager' : 'lazy'}
                  priority={index < 6}
                  sizes="(min-width: 1024px) 33vw, (min-width: 768px) 50vw, 100vw"
                  width={400}
                  height={400}
                />
              </div>
              <div class="p-4 space-y-2">
                <h3 class="font-semibold text-foreground text-base group-hover:text-primary transition-colors line-clamp-1">
                  {image.title}
                </h3>
                <p class="text-sm text-muted-foreground line-clamp-2">{image.description}</p>
                <div class="flex items-center gap-2 text-xs text-muted-foreground">
                  <Icon name="lucide:calendar" class="w-3 h-3" />
                  <time datetime={image.date}>
                    {new Intl.DateTimeFormat('zh-CN', { year: 'numeric', month: 'short', day: 'numeric' }).format(new Date(image.date))}
                  </time>
                </div>
              </div>
            </div>
          </ScrollReveal>
        ))}
      </div>

      {galleryImages.length === 0 && (
        <div class="text-center py-12 border border-dashed border-border/60 rounded-2xl">
          <Icon name="lucide:image" class="w-10 h-10 text-muted-foreground mx-auto mb-3" />
          <p class="text-muted-foreground">æš‚æ— ç…§ç‰‡ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p>
        </div>
      )}
    </section>

    <!-- Footer Links -->
    <div class="flex justify-center pt-12 pb-8">
      <Link href="/" class={buttonVariants({ variant: 'ghost' }) + ' group text-muted-foreground hover:text-foreground transition-colors'}>
        <Icon name="lucide:arrow-left" class="mr-2 size-4 transition-transform group-hover:-translate-x-1" />
        è¿”å›é¦–é¡µ
      </Link>
    </div>

  </div>
</Layout>
