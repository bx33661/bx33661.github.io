---
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const galleries = await getCollection("galleries", ({ data }) => !data.draft);
  return galleries.map(gallery => ({
    params: {
      gallery: gallery.id
        .replace(/\\/g, "/")
        .replace(/\/index\.(md|mdx)$/, "")
        .replace(/\.(md|mdx)$/, ""),
    },
  }));
}

const slug = Astro.params.gallery ?? "";
const target = `/galleries/${slug}/`;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="refresh" content={`0;url=${target}`} />
    <link rel="canonical" href={target} />
    <title>Redirecting...</title>
  </head>
  <body>
    <p>Redirecting to <a href={target}>{target}</a>...</p>
  </body>
</html>
